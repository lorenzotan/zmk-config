/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>

#define DEFAULT 0
#define NAVNUM 1
#define SYMBOL 2
#define FUNCTION 3

/ {
        behaviors {
                l_skp_wrd: l_skip_word {
                        compatible = "zmk,behavior-tap-dance";
                        #binding-cells = <0>;
                        tapping-term-ms = <200>;
                        bindings = <&kp LA(LEFT)>, <&kp HOME>;
                };
                r_skp_wrd: r_skip_word {
                        compatible = "zmk,behavior-tap-dance";
                        #binding-cells = <0>;
                        tapping-term-ms = <200>;
                        bindings = <&kp LA(RIGHT)>, <&kp END>;
                };
                // num_sym: number_symbol_layers {
                //         compatible = "zmk,behavior-tap-dance";
                //         #binding-cells = <0>;
                //         tapping-term-ms = <200>;
                //         bindings = <&tog NAVNUM>, <&tog SYMBOL>, <&tog FUNCTION>;
                // };
                rpi: require_prior_idle {
                        compatible = "zmk,behavior-hold-tap";
                        #binding-cells = <2>;
                        flavor = "tap-preferred";
                        tapping-term-ms = <200>;
                        quick-tap-ms = <200>;
                        require-prior-idle-ms = <125>;
                        bindings = <&kp>, <&kp>;
                };
        };
        combos {
                compatible = "zmk,combos";
                combo_layer {
                        timeout-ms = <50>;
                        key-positions = <38 39>;
                        bindings = <&mo FUNCTION>;
                };
        };
        keymap {
                compatible = "zmk,keymap";

                default_layer {
                        bindings = <
// +-----------+-------------+-------------+------------+------------+-----------+      +------------+------------+------------+-------------+----------------+-----------+
   &kp ESC       &kp Q         &kp W         &kp E        &kp R        &kp T              &kp Y        &kp U        &kp I        &kp O         &kp P            &kp BSPC
// +-----------+-------------+-------------+------------+------------+-----------+      +------------+------------+------------+-------------+----------------+-----------+
   &kp TAB       &rpi LSHFT A  &rpi LCTRL S  &rpi LALT D  &rpi LGUI F  &kp G              &kp H        &rpi RGUI J  &rpi RALT K  &rpi RCTRL L  &rpi RSHFT SEMI  &kp SQT
// +-----------+-------------+-------------+------------+------------+-----------+      +------------+------------+------------+-------------+----------------+-----------+
   &kp TILDE     &kp Z         &kp X         &kp C        &kp V        &kp B              &kp N        &kp M        &kp COMMA    &kp DOT       &kp FSLH         &kp BSLH
// +-----------+-------------+-------------+------------+------------+-----------+      +------------+------------+------------+-------------+----------------+-----------+
                                             &none        &kp SPACE    &mo NAVNUM         &mo SYMBOL   &kp RET      &none
//                                         +------------+------------+-----------+      +------------+------------+------------+
                        >;
                };
                num_layer {
                        bindings = <
// +---------+------------+------------+----------+------------+-----------+    +------------+--------+--------+--------+-----------+-----------+
    &kp ESC    &none        &l_skp_wrd   &kp UP     &r_skp_wrd   &kp PG_UP        &kp SLASH    &kp N7   &kp N8   &kp N9   &kp MINUS   &kp BSPC
// +---------+------------+------------+----------+------------+-----------+    +------------+--------+--------+--------+-----------+-----------+
    &kp TAB    &kp LSHIFT   &kp LEFT     &kp DOWN   &kp RIGHT    &kp PG_DN        &kp ASTRK    &kp N4   &kp N5   &kp N6   &kp PLUS    &none
// +---------+------------+------------+----------+------------+-----------+    +------------+--------+--------+--------+-----------+-----------+
    &kp TILDE  &none        &none        &none      &none        &none            &kp PERIOD   &kp N1   &kp N2   &kp N3   &kp RET     &none
// +---------+------------+------------+----------+------------+-----------+    +------------+--------+--------+--------+-----------+-----------+
                                         &none      &none        &none            &none        &kp N0   &none
//                                     +----------+------------+-----------+    +------------+--------+--------+
                        >;
                };

                symbol_layer {
                        bindings = <
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+-----------+-----------+----------+----------+-----------+
     &kp TILDE   &kp EXCL    &kp AT      &kp HASH    &kp DLLR    &kp PRCNT        &kp CARET      &kp AMPS    &kp ASTRK   &kp LPAR   &kp RPAR   &kp BSPC
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+-----------+-----------+----------+----------+-----------+
     &none       &none       &none       &none       &none       &none            &kp MINUS      &kp EQUAL   &none       &kp LBKT   &kp RBKT   &kp BSLH
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+-----------+-----------+----------+----------+-----------+
     &none       &none       &none       &none       &none       &none            &kp UNDER      &kp PLUS    &none       &kp LBRC   &kp RBRC   &none
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+-----------+-----------+----------+----------+-----------+
                                         &kp LGUI    &kp SPACE   &kp LSHFT        &to DEFAULT    &kp RET     &kp RALT
//                                     +-----------+-----------+-----------+    +--------------+-----------+-----------+
                        >;
                };

                function_layer {
                        bindings = <
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+--------------+--------------+-----------+-----------+-----------+
     &kp F1      &kp F2      &kp F3      &kp F4      &kp F5      &kp F6           &bt BT_CLR     &none          &kp C_MUTE     &none       &none       &none
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+--------------+--------------+-----------+-----------+-----------+
     &kp F7      &kp F8      &kp F9      &kp F10     &kp F11     &kp F12          &bt BT_SEL 0   &kp C_BRI_UP   &kp C_VOL_UP   &none       &none       &none
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+--------------+--------------+-----------+-----------+-----------+
     &kp LG(1)   &kp LG(2)   &kp LG(3)   &kp LG(4)   &kp LG(5)   &kp LG(6)        &bt BT_SEL 1   &kp C_BRI_DN   &kp C_VOL_DN   &none       &none       &none
// +-----------+-----------+-----------+-----------+-----------+-----------+    +--------------+--------------+--------------+-----------+-----------+-----------+
                                         &none       &none       &none            &none          &none          &none
//                                     +-----------+-----------+-----------+    +--------------+--------------+--------------+
                        >;
                };
        };
};
